{"version":3,"file":"dom-inject.modern.mjs","sources":["../src/index.js"],"sourcesContent":["/**\n * Written by Elliott Mangham at Code Resolution. Maintained by Code Resolution.\n * made@coderesolution.com\n */\nexport default class DomInject {\n\tconstructor(options = {}) {\n\t\tthis.options = {\n\t\t\tloadingClass: options.loadingClass || 'loading',\n\t\t\tloadedClass: options.loadedClass || 'loaded',\n\t\t\terrorClass: options.errorClass || 'error',\n\t\t\t...options,\n\t\t}\n\t}\n\n\tfetchContent(sourceUrl, sourceScope = null, includeParent = false) {\n\t\tconst url = sourceUrl || window.location.href\n\t\treturn fetch(url)\n\t\t\t.then((response) => {\n\t\t\t\tif (!response.ok) {\n\t\t\t\t\tthrow new Error('Network response was not ok.')\n\t\t\t\t}\n\t\t\t\treturn response.text()\n\t\t\t})\n\t\t\t.then((data) => {\n\t\t\t\tconst parser = new DOMParser()\n\t\t\t\tconst doc = parser.parseFromString(data, 'text/html')\n\t\t\t\tconst element = sourceScope ? doc.querySelector(sourceScope) : doc.body\n\t\t\t\tif (!element) {\n\t\t\t\t\tthrow new Error(`Element not found for selector: ${sourceScope}`)\n\t\t\t\t}\n\t\t\t\treturn includeParent && sourceScope ? element.outerHTML : element.innerHTML\n\t\t\t})\n\t}\n\n\tloadContent(\n\t\ttarget,\n\t\tsourceUrl = null,\n\t\tsourceScope = null,\n\t\t{ mode = 'replace', beforeFetch = null, afterFetch = null, includeParent = false } = {}\n\t) {\n\t\tconst targetElement = typeof target === 'string' ? document.querySelector(target) : target\n\t\tif (!targetElement) {\n\t\t\tconsole.error(`Target element not found.`)\n\t\t\treturn\n\t\t}\n\n\t\tthis._toggleLoadingState(targetElement, true)\n\n\t\tif (beforeFetch) {\n\t\t\tbeforeFetch(targetElement)\n\t\t}\n\n\t\tthis.fetchContent(sourceUrl, sourceScope, includeParent)\n\t\t\t.then((html) => {\n\t\t\t\tif (mode === 'prepend') {\n\t\t\t\t\ttargetElement.insertAdjacentHTML('afterbegin', html)\n\t\t\t\t} else if (mode === 'append') {\n\t\t\t\t\ttargetElement.insertAdjacentHTML('beforeend', html)\n\t\t\t\t} else {\n\t\t\t\t\t// default to 'replace'\n\t\t\t\t\ttargetElement.innerHTML = html\n\t\t\t\t}\n\n\t\t\t\tthis._toggleLoadingState(targetElement, false)\n\n\t\t\t\tif (afterFetch) {\n\t\t\t\t\tafterFetch(targetElement)\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error('Error fetching content:', error)\n\t\t\t\tthis._toggleLoadingState(targetElement, false, true)\n\t\t\t})\n\t}\n\n\t_toggleLoadingState(element, isLoading, isError = false) {\n\t\telement.classList.toggle(this.options.loadingClass, isLoading)\n\t\telement.classList.toggle(this.options.loadedClass, !isLoading && !isError)\n\t\telement.classList.toggle(this.options.errorClass, isError)\n\t}\n}\n"],"names":["DomInject","constructor","options","this","_extends","loadingClass","loadedClass","errorClass","fetchContent","sourceUrl","sourceScope","includeParent","url","window","location","href","fetch","then","response","ok","Error","text","data","doc","DOMParser","parseFromString","element","querySelector","body","outerHTML","innerHTML","loadContent","target","mode","beforeFetch","afterFetch","targetElement","document","_toggleLoadingState","html","insertAdjacentHTML","catch","error","console","isLoading","isError","classList","toggle"],"mappings":"wNAIe,MAAMA,EACpBC,WAAAA,CAAYC,EAAU,CAAA,GACrBC,KAAKD,QAAOE,EAAA,CACXC,aAAcH,EAAQG,cAAgB,UACtCC,YAAaJ,EAAQI,aAAe,SACpCC,WAAYL,EAAQK,YAAc,SAC/BL,EAEL,CAEAM,YAAAA,CAAaC,EAAWC,EAAc,KAAMC,GAAgB,GAC3D,MAAMC,EAAMH,GAAaI,OAAOC,SAASC,KACzC,OAAOC,MAAMJ,GACXK,KAAMC,IACN,IAAKA,EAASC,GACb,MAAU,IAAAC,MAAM,gCAEjB,OAAOF,EAASG,MACjB,GACCJ,KAAMK,IACN,MACMC,GADS,IAAIC,WACAC,gBAAgBH,EAAM,aACnCI,EAAUhB,EAAca,EAAII,cAAcjB,GAAea,EAAIK,KACnE,IAAKF,EACJ,MAAU,IAAAN,MAAM,mCAAmCV,KAEpD,OAAOC,GAAiBD,EAAcgB,EAAQG,UAAYH,EAAQI,WAErE,CAEAC,WAAAA,CACCC,EACAvB,EAAY,KACZC,EAAc,MACduB,KAAEA,EAAO,UAASC,YAAEA,EAAc,KAAIC,WAAEA,EAAa,KAAIxB,cAAEA,GAAgB,GAAU,IAErF,MAAMyB,EAAkC,iBAAXJ,EAAsBK,SAASV,cAAcK,GAAUA,EAC/EI,GAKLjC,KAAKmC,oBAAoBF,GAAe,GAEpCF,GACHA,EAAYE,GAGbjC,KAAKK,aAAaC,EAAWC,EAAaC,GACxCM,KAAMsB,IACO,YAATN,EACHG,EAAcI,mBAAmB,aAAcD,GAC5B,WAATN,EACVG,EAAcI,mBAAmB,YAAaD,GAG9CH,EAAcN,UAAYS,EAG3BpC,KAAKmC,oBAAoBF,GAAe,GAEpCD,GACHA,EAAWC,EACZ,GAEAK,MAAOC,IACPC,QAAQD,MAAM,0BAA2BA,GACzCvC,KAAKmC,oBAAoBF,GAAe,GAAO,EAAI,IA7BpDO,QAAQD,MAAM,4BA+BhB,CAEAJ,mBAAAA,CAAoBZ,EAASkB,EAAWC,GAAU,GACjDnB,EAAQoB,UAAUC,OAAO5C,KAAKD,QAAQG,aAAcuC,GACpDlB,EAAQoB,UAAUC,OAAO5C,KAAKD,QAAQI,aAAcsC,IAAcC,GAClEnB,EAAQoB,UAAUC,OAAO5C,KAAKD,QAAQK,WAAYsC,EACnD"}