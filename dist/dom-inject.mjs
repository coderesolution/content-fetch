import e from"dompurify";function r(e,r){(null==r||r>e.length)&&(r=e.length);for(var o=0,t=Array(r);o<r;o++)t[o]=e[o];return t}function o(){return o=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var t in o)({}).hasOwnProperty.call(o,t)&&(e[t]=o[t])}return e},o.apply(null,arguments)}var t=/*#__PURE__*/function(){function t(e){void 0===e&&(e={}),this.options=o({loadingClass:e.loadingClass||"is-loading",loadedClass:e.loadedClass||"has-loaded",errorClass:e.errorClass||"has-error",debugMode:e.debugMode||!1},e),this.cache=new Map,this.controller=new AbortController}var n=t.prototype;return n.log=function(e){this.options.debugMode&&console.log(e)},n.fetchContent=function(r,o,t){var n=this;return void 0===o&&(o=null),void 0===t&&(t=!1),fetch(r,{signal:this.controller.signal}).then(function(e){if(!e.ok)throw new Error("Network response was not ok.");return n.log("Fetch response received"),e.text()}).then(function(r){var i=(new DOMParser).parseFromString(r,"text/html"),a=o?i.querySelector(o):i.body;if(!a)throw new Error("Element not found for selector: "+o);return n.log("Parsed HTML and found element"),e.sanitize(t&&o?a.outerHTML:a.innerHTML)})},n.from=function(r){var o=this,t=r.selector,n=r.url,i=void 0===n?window.location.href:n,a=r.includeParent,s=void 0!==a&&a,c=r.onStart,l=r.onEnd,d=r.onError;if(!t){var u=new Error("Selector must be defined.");return d?d(u):console.error(u),Promise.reject(u)}c&&c();var f=i+"-"+t+"-"+s;return this.log("Cache key is: "+f),new Promise(function(r,n){if(o.cache.has(f)){var a=o.cache.get(f);return o.log("Serving from cache"),l&&l(a),void r(a)}if(o.log("Fetching data from URL: "+i),i===window.location.href){var c=document.querySelector(t);if(!c){var u=new Error("Element not found for selector: "+t);return d?d(u):console.error(u),n(u)}var h=e.sanitize(s?c.outerHTML:c.innerHTML);o.cache.set(f,h),l&&l(h),r(h)}else o.fetchContent(i,t,s).then(function(e){o.cache.set(f,e),l&&l(e),r(e)}).catch(function(e){d?d(e):console.error("Error fetching content:",e),n(e)})})},n.to=function(e){var o=this,t=e.destination,n=e.data,i=e.mode,a=void 0===i?"replace":i,s=e.delay,c=void 0===s?0:s,l=e.onStart,d=e.onEnd,u=e.onError;if(!t||!n){var f=new Error("Destination and data must be defined.");return u?u(f):console.error(f),Promise.reject(f)}var h="string"==typeof t?document.querySelector(t):t;if(!h){var v=new Error("Target element not found for selector: "+t);return u?u(v):console.error(v),Promise.reject(v)}l&&l(h),h.classList.add(this.options.loadingClass);var m=function(){try{o.log("Inserting content via '"+a+"' mode"),document.createDocumentFragment();var e=document.createElement("div");if(e.innerHTML=n,"prepend"===a)for(var t,i=function(e,o){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=function(e,o){if(e){if("string"==typeof e)return r(e,o);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?r(e,o):void 0}}(e))){t&&(e=t);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}([].concat(e.childNodes).reverse());!(t=i()).done;)h.insertBefore(t.value,h.firstChild);else"append"===a||(h.innerHTML=""),h.appendChild(e);return h.classList.remove(o.options.loadingClass),h.classList.add(o.options.loadedClass),d&&d(h),Promise.resolve(h)}catch(e){return h.classList.remove(o.options.loadingClass),h.classList.add(o.options.errorClass),u?u(e):console.error("Error inserting content:",e),Promise.reject(e)}};if(!(c>0))return m();this.log("Delaying insertion by "+c+" seconds"),setTimeout(m,1e3*c)},n.fromTo=function(e,r){var t=this;this.from(e).then(function(e){return t.to(o({},r,{data:e}))}).catch(function(e){})},n.abortFetch=function(){this.controller.abort(),this.controller=new AbortController,this.cache.clear()},t}();window.ContentFetch=t;export{t as default};
//# sourceMappingURL=dom-inject.mjs.map
