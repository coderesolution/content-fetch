!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("dompurify")):"function"==typeof define&&define.amd?define(["dompurify"],r):(e||self).domInject=r(e.dompurify)}(this,function(e){function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=/*#__PURE__*/r(e);function t(e,r){(null==r||r>e.length)&&(r=e.length);for(var o=0,t=Array(r);o<r;o++)t[o]=e[o];return t}function n(){return n=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var t in o)({}).hasOwnProperty.call(o,t)&&(e[t]=o[t])}return e},n.apply(null,arguments)}var i=/*#__PURE__*/function(){function e(e){void 0===e&&(e={}),this.options=n({loadingClass:e.loadingClass||"is-loading",loadedClass:e.loadedClass||"has-loaded",errorClass:e.errorClass||"has-error",debugMode:e.debugMode||!1},e),this.cache=new Map,this.controller=new AbortController}var r=e.prototype;return r.log=function(e){this.options.debugMode&&console.log(e)},r.fetchContent=function(e,r,t){var n=this;return void 0===r&&(r=null),void 0===t&&(t=!1),fetch(e,{signal:this.controller.signal}).then(function(e){if(!e.ok)throw new Error("Network response was not ok.");return n.log("Fetch response received"),e.text()}).then(function(e){var i=(new DOMParser).parseFromString(e,"text/html"),a=r?i.querySelector(r):i.body;if(!a)throw new Error("Element not found for selector: "+r);return n.log("Parsed HTML and found element"),o.default.sanitize(t&&r?a.outerHTML:a.innerHTML)})},r.from=function(e){var r=this,t=e.selector,n=e.url,i=void 0===n?window.location.href:n,a=e.includeParent,s=void 0!==a&&a,l=e.onStart,c=e.onEnd,d=e.onError;if(!t){var u=new Error("Selector must be defined.");return d?d(u):console.error(u),Promise.reject(u)}l&&l();var f=i+"-"+t+"-"+s;return this.log("Cache key is: "+f),new Promise(function(e,n){if(r.cache.has(f)){var a=r.cache.get(f);return r.log("Serving from cache"),c&&c(a),void e(a)}if(r.log("Fetching data from URL: "+i),i===window.location.href){var l=document.querySelector(t);if(!l){var u=new Error("Element not found for selector: "+t);return d?d(u):console.error(u),n(u)}var h=o.default.sanitize(s?l.outerHTML:l.innerHTML);r.cache.set(f,h),c&&c(h),e(h)}else r.fetchContent(i,t,s).then(function(o){r.cache.set(f,o),c&&c(o),e(o)}).catch(function(e){d?d(e):console.error("Error fetching content:",e),n(e)})})},r.to=function(e){var r=this,o=e.destination,n=e.data,i=e.mode,a=void 0===i?"replace":i,s=e.delay,l=void 0===s?0:s,c=e.onStart,d=e.onEnd,u=e.onError;if(!o||!n){var f=new Error("Destination and data must be defined.");return u?u(f):console.error(f),Promise.reject(f)}var h="string"==typeof o?document.querySelector(o):o;if(!h){var m=new Error("Target element not found for selector: "+o);return u?u(m):console.error(m),Promise.reject(m)}c&&c(h),h.classList.add(this.options.loadingClass);var v=function(){try{r.log("Inserting content via '"+a+"' mode"),document.createDocumentFragment();var e=document.createElement("div");if(e.innerHTML=n,"prepend"===a)for(var o,i=function(e,r){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(o)return(o=o.call(e)).next.bind(o);if(Array.isArray(e)||(o=function(e,r){if(e){if("string"==typeof e)return t(e,r);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?t(e,r):void 0}}(e))){o&&(e=o);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}([].concat(e.childNodes).reverse());!(o=i()).done;)h.insertBefore(o.value,h.firstChild);else"append"===a||(h.innerHTML=""),h.appendChild(e);return h.classList.remove(r.options.loadingClass),h.classList.add(r.options.loadedClass),d&&d(h),Promise.resolve(h)}catch(e){return h.classList.remove(r.options.loadingClass),h.classList.add(r.options.errorClass),u?u(e):console.error("Error inserting content:",e),Promise.reject(e)}};if(!(l>0))return v();this.log("Delaying insertion by "+l+" seconds"),setTimeout(v,1e3*l)},r.fromTo=function(e,r){var o=this;this.from(e).then(function(e){return o.to(n({},r,{data:e}))}).catch(function(e){})},r.abortFetch=function(){this.controller.abort(),this.controller=new AbortController,this.cache.clear()},e}();return window.ContentFetch=i,i});
//# sourceMappingURL=dom-inject.umd.js.map
